// Wait for the document to be fully loaded
document.addEventListener('DOMContentLoaded', function() {
    console.log("Django Blog JavaScript initialized");
    
    // Auto-generate slug from title in post creation/editing form
    const titleInput = document.getElementById('id_title');
    const slugInput = document.getElementById('id_slug');
    
    if (titleInput && slugInput) {
        // Initialize the data-autogenerated attribute if not set
        if (!slugInput.dataset.autogenerated) {
            slugInput.dataset.autogenerated = String(true);
        }
        titleInput.addEventListener('blur', function() {
            const slug = titleInput.value
                .trim()                   // Trim whitespace
                .toLowerCase()
                .replace(/[^\w\s-]/g, '') // Remove special chars
                .replace(/\s+/g, '-')     // Replace spaces with dashes
                .replace(/-+/g, '-');     // Remove multiple dashes
            
            slugInput.value = slug;
            slugInput.dataset.autogenerated = 'true';
        });
    }
        function debounce(func, wait) {
            let timeout;
            return function(...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        slugInput.addEventListener('input', debounce(function() {
            slugInput.dataset.autogenerated = String(false);
        }, 300));
    }   

);
